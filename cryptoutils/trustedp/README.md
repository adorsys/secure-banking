# Trusted Party

## Secure Key Recovery Protocol

The idea behind this module is to allow for secure key backup and recovery.

The backup process consists in using some trusted parties public to protect the target secret key. The secret key is then used to protect access to the payload (Generally a keystore). 

### Terminology:

E ist the entity owning the keypair (Epub, Epriv)
X ist the entity owning the keypair (Xpub, Xpriv)
Y ist the entity owning the keypair (Ypub, Ypriv)
Z ist the entity owning the keypair (Zpub, Zpriv)

Let A = PubKeyEnc(Xpub, data) means "data" is the information being public key encrypted using public key "Xpub". Data can only be recovered if decrypter is in possesion of "Xpriv"

Let A = SecretEnc(s, data) means "data" is the information being symetricaly encrypted using the secret key "s". Data can only be recovered if decrypter is in possession of "s".

E can protect his key pair (Epub, Epriv) by entrusting an encryption secret to X.

Let secretM be the master secret used by E to encrypt his Epriv. 
Let Data0 be the master secret encrypted payload. Data0 = SecretEnc(secretM, Epriv);
Let secretEX be the secret generated by E to protect the master secret.
Let Data1 be the master secret protected by secretEX. Data1 = PubKeyEnc(Xpub, secretM); 

In order to recover secretM    

Ds = SecretEnc(secret, Ppriv) 
Dxy = PubKeyEnc(Ypub, PubKeyEnc(Xpub, secret));
Dxz = PubKeyEnc(Zpub, PubKeyEnc(Xpub, secret));
Dyz = PubKeyEnc(Zpub, PubKeyEnc(Ypub, secret)))

Data records Dxy, Dxz and Dyz can be stored on the server.


 
